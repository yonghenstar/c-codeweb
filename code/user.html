<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">C++代码分享平台 - 用户信息</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0a192f',
                        secondary: '#64ffda',
                        accent: '#112240',
                        light: '#e6f1ff',
                        dark: '#020c1b'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['Fira Code', 'monospace']
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' }
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            }
            .glass {
                background: rgba(10, 25, 47, 0.7);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                border: 1px solid rgba(100, 255, 218, 0.1);
            }
            .gradient-text {
                background: linear-gradient(90deg, #64ffda, #a8fff0);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
            }
            .bg-gradient-primary {
                background: linear-gradient(135deg, #0a192f 0%, #112240 100%);
            }
            .bg-animation {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
                z-index: -1;
            }
            .bg-animation li {
                position: absolute;
                display: block;
                list-style: none;
                background: rgba(100, 255, 218, 0.1);
                animation: animate 25s linear infinite;
                bottom: -150px;
                border-radius: 50%;
            }
            @keyframes animate {
                0% {
                    transform: translateY(0) rotate(0deg);
                    opacity: 0.5;
                    border-radius: 50%;
                }
                100% {
                    transform: translateY(-1000px) rotate(720deg);
                    opacity: 0;
                    border-radius: 50%;
                }
            }
        }
    </style>
</head>
<body class="bg-gradient-primary text-light min-h-screen flex flex-col">
    <!-- Background Animation -->
    <ul class="bg-animation">
        <li style="left: 25%; width: 80px; height: 80px; animation-delay: 0s; animation-duration: 18s;"></li>
        <li style="left: 10%; width: 20px; height: 20px; animation-delay: 2s; animation-duration: 12s;"></li>
        <li style="left: 70%; width: 20px; height: 20px; animation-delay: 4s; animation-duration: 10s;"></li>
        <li style="left: 40%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 15s;"></li>
        <li style="left: 65%; width: 20px; height: 20px; animation-delay: 0s; animation-duration: 11s;"></li>
        <li style="left: 75%; width: 110px; height: 110px; animation-delay: 3s; animation-duration: 20s;"></li>
        <li style="left: 35%; width: 150px; height: 150px; animation-delay: 7s; animation-duration: 25s;"></li>
        <li style="left: 50%; width: 25px; height: 25px; animation-delay: 15s; animation-duration: 35s;"></li>
        <li style="left: 20%; width: 15px; height: 15px; animation-delay: 2s; animation-duration: 40s;"></li>
        <li style="left: 85%; width: 150px; height: 150px; animation-delay: 0s; animation-duration: 25s;"></li>
    </ul>

    <!-- Main Content -->
    <div id="main-page" class="flex flex-col min-h-screen">
        <!-- Header with Time -->
        <header class="glass py-4 px-6 md:px-12">
            <div class="container mx-auto flex justify-between items-center">
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center hover:text-secondary transition-colors duration-300">
                        <i class="fa fa-arrow-left mr-2"></i>
                        <span class="text-gray-300">返回主页</span>
                    </a>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-code text-secondary text-2xl mr-3"></i>
                    <h1 class="text-xl md:text-2xl font-bold gradient-text">C++代码分享平台</h1>
                </div>
                <div id="current-time" class="text-sm md:text-base font-mono"></div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="flex-grow container mx-auto py-8 px-4 md:px-8">
            <div class="max-w-4xl mx-auto">
                <!-- User Profile Section -->
                <div class="glass rounded-lg p-8 mb-8">
                    <div class="flex flex-col md:flex-row items-center md:items-start gap-8">
                        <!-- User Avatar -->
                        <div class="w-32 h-32 rounded-full bg-accent overflow-hidden border-4 border-secondary flex-shrink-0">
                            <img src="" alt="用户头像" class="w-full h-full object-cover" id="user-avatar">
                        </div>
                        
                        <!-- User Info -->
                        <div class="text-center md:text-left">
                            <h2 id="user-name" class="text-3xl md:text-4xl font-bold mb-4 text-shadow">加载中...</h2>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-secondary bg-opacity-20 flex items-center justify-center mr-3">
                                        <i class="fa fa-calendar text-secondary"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-400">加入时间</p>
                                        <p id="join-date" class="font-medium">加载中...</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-secondary bg-opacity-20 flex items-center justify-center mr-3">
                                        <i class="fa fa-code text-secondary"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-400">上传代码数</p>
                                        <p id="code-count" class="font-medium">加载中...</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contact Info -->
                            <div class="mb-6">
                                <h3 class="text-lg font-semibold mb-3 flex items-center">
                                    <i class="fa fa-envelope text-secondary mr-2"></i>
                                    联系方式
                                </h3>
                                <p id="contact-info" class="text-gray-300">
                                    加载中...
                                </p>
                            </div>
                            
                            <!-- User Bio -->
                            <div>
                                <h3 class="text-lg font-semibold mb-3 flex items-center">
                                    <i class="fa fa-user text-secondary mr-2"></i>
                                    个人简介
                                </h3>
                                <p id="user-bio" class="text-gray-300 leading-relaxed">
                                    加载中...
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- User's Code Examples -->
                <div class="glass rounded-lg p-8">
                    <h3 class="text-xl font-semibold mb-6 flex items-center">
                        <i class="fa fa-code-fork text-secondary mr-2"></i>
                        <span id="user-code-title">加载中...</span>
                    </h3>
                    
                    <div id="user-code-list" class="space-y-6">
                        <!-- User's code examples will be dynamically generated here -->
                        <div class="flex justify-center items-center py-12 text-gray-400">
                            <i class="fa fa-spinner fa-spin text-2xl mr-3"></i>
                            <span>加载中...</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="glass py-6 px-4">
            <div class="container mx-auto text-center">
                <p id="copyright" class="text-sm md:text-base text-gray-400 cursor-pointer hover:text-secondary transition-colors duration-300">
                    CST协会代码分享平台 | 2025
                </p>
                <p class="text-xs text-gray-500 mt-2">
                    <i class="fa fa-code-fork mr-1"></i> 分享知识，共同进步
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Initialize and load user data based on URL parameter
        document.addEventListener('DOMContentLoaded', () => {
            updateTime();
            setInterval(updateTime, 1000);
            
            // Load user data based on URL parameter
            loadUserDataFromUrl();
        });
        
        // Get URL parameter by name
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }
        
        // Load code data from localStorage
        function loadCodeDataFromLocalStorage() {
            const savedData = localStorage.getItem('codeData');
            return savedData ? JSON.parse(savedData) : [];
        }
        
        // Load user data based on URL parameter
        function loadUserDataFromUrl() {
            const userName = getUrlParameter('name');
            
            if (!userName) {
                showError('无效的用户名参数');
                return;
            }
            
            // Load user's code examples
            const codeData = loadCodeDataFromLocalStorage();
            const userCodeExamples = codeData.filter(code => code.author === userName);
            
            if (userCodeExamples.length === 0) {
                showError('未找到该用户的信息');
                return;
            }
            
            // Get user info
            const userInfo = getUserInfo(userName);
            
            // Update page content with user data
            document.getElementById('page-title').textContent = `C++代码分享平台 - ${userName}的个人主页`;
            document.getElementById('user-name').textContent = userName;
            document.getElementById('join-date').textContent = userInfo.joinDate;
            document.getElementById('code-count').textContent = userCodeExamples.length;
            document.getElementById('contact-info').textContent = userInfo.contact;
            document.getElementById('user-bio').textContent = userInfo.bio;
            document.getElementById('user-code-title').textContent = `${userName}分享的代码示例`;
            
            // Set user avatar from specified URL
            const avatarUrl = `https://cst.de5.net/user/${encodeURIComponent(userName)}/icon.png`;
            
            // Try to load avatar from the specified URL
            loadAvatarFromRemoteUrl(avatarUrl, userName);
            
            // Generate user's code examples list
            generateUserCodeList(userCodeExamples);
        }
        
        // Get user info based on username
        function getUserInfo(userName) {
            // In a real application, this data would come from a database
            // For this demo, we'll return hardcoded data based on username
            const userInfoMap = {
                '永恒星': {
                    joinDate: '2025-05-20',
                    contact: 'eternal_star@example.com',
                    bio: 'C++资深开发者，擅长高性能计算和系统编程。热爱分享技术经验，希望能帮助更多人掌握C++编程技巧。'
                },
                'Command_stone': {
                    joinDate: '2025-06-15',
                    contact: 'command_stone@example.com',
                    bio: '算法竞赛爱好者，曾获得多个编程比赛奖项。专注于算法优化和问题解决，喜欢挑战复杂的编程问题。'
                },
                'Command_star': {
                    joinDate: '2025-06-18',
                    contact: 'command_star@example.com',
                    bio: '游戏开发工程师，擅长使用C++进行高性能游戏引擎开发。对图形学和物理模拟有深入研究。'
                },
                '新用户1': {
                    joinDate: '2025-07-01',
                    contact: 'newuser1@example.com',
                    bio: 'C++编程初学者，正在学习基础语法和面向对象编程。希望通过分享学习过程，与其他初学者共同进步。'
                },
                '新用户2': {
                    joinDate: '2025-07-05',
                    contact: 'newuser2@example.com',
                    bio: '计算机科学专业学生，对数据结构和算法有浓厚兴趣。正在学习C++并尝试解决各种编程问题。'
                },
                '新用户3': {
                    joinDate: '2025-07-10',
                    contact: 'newuser3@example.com',
                    bio: '软件工程师，主要使用C++进行后端开发。喜欢研究设计模式和性能优化技术。'
                },
                '新用户4': {
                    joinDate: '2025-07-15',
                    contact: 'newuser4@example.com',
                    bio: '嵌入式系统开发者，擅长使用C++进行嵌入式软件设计。对实时系统和低功耗编程有丰富经验。'
                },
                '编程爱好者': {
                    joinDate: '2025-01-15',
                    contact: 'programmer@example.com',
                    bio: '热爱编程，尤其擅长C++和数据结构。喜欢分享编程知识和经验，希望能帮助更多人学习编程。'
                },
                '算法专家': {
                    joinDate: '2024-11-20',
                    contact: 'algorithm@example.com',
                    bio: '算法研究员，专注于图论和动态规划算法研究。曾参与多个算法竞赛，并获得优异成绩。'
                },
                '动态规划爱好者': {
                    joinDate: '2025-02-05',
                    contact: 'dp_lover@example.com',
                    bio: '动态规划算法爱好者，热衷于解决各类动态规划问题，并总结解题技巧和方法。'
                },
                '排序专家': {
                    joinDate: '2024-12-10',
                    contact: 'sorting@example.com',
                    bio: '排序算法专家，对各类排序算法有深入研究，擅长优化算法性能。'
                },
                '现代C++爱好者': {
                    joinDate: '2025-03-18',
                    contact: 'modern_cpp@example.com',
                    bio: '专注于现代C++特性研究和应用，包括智能指针、lambda表达式、STL等。'
                },
                '编程入门者': {
                    joinDate: '2025-04-10',
                    contact: 'beginner@example.com',
                    bio: '编程初学者，正在学习C++基础语法和编程思想。希望通过分享自己的学习过程，与其他初学者共同进步。'
                }
            };
            
            // Return default info if user not found
            return userInfoMap[userName] || {
                joinDate: '2025-01-01',
                contact: 'user@example.com',
                bio: '热爱编程，喜欢分享代码和经验。'
            };
        }
        
        // Generate user's code examples list
        function generateUserCodeList(codeExamples) {
            const codeListContainer = document.getElementById('user-code-list');
            codeListContainer.innerHTML = '';
            
            if (codeExamples.length === 0) {
                codeListContainer.innerHTML = '<div class="text-center py-12 text-gray-400"><i class="fa fa-code text-4xl mb-4"></i><p>该用户尚未分享任何代码示例</p></div>';
                return;
            }
            
            // Get category name
            const categoryNames = {
                'data-structure': '数据结构',
                'algorithm': '算法',
                'basic': '基础语法',
                'advanced': '高级特性'
            };
            
            codeExamples.forEach(code => {
                const codeItem = document.createElement('div');
                codeItem.className = 'glass rounded-lg overflow-hidden hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 cursor-pointer';
                codeItem.onclick = () => navigateToCodePage(code.id);
                
                codeItem.innerHTML = `
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="text-xl font-bold mb-2">${code.title}</h3>
                            <span class="text-xs bg-secondary bg-opacity-20 text-secondary px-2 py-1 rounded">${categoryNames[code.category] || code.category}</span>
                        </div>
                        <p class="text-gray-300 text-sm mb-4 line-clamp-2">${code.description}</p>
                        <div class="flex justify-between items-center text-xs text-gray-400">
                            <span><i class="fa fa-calendar mr-1"></i> ${code.date}</span>
                        </div>
                    </div>
                    <div class="bg-accent bg-opacity-50 px-6 py-3 flex justify-between items-center">
                        <span class="text-sm font-mono text-gray-300">查看详情</span>
                        <i class="fa fa-arrow-right text-secondary"></i>
                    </div>
                `;
                
                codeListContainer.appendChild(codeItem);
            });
        }
        
        // Navigate to code page with ID parameter
        function navigateToCodePage(id) {
            window.location.href = `https://cst.de5.net/code/${id}.html`;
        }
        
        // Load avatar from remote URL
        function loadAvatarFromRemoteUrl(avatarUrl, userName) {
            const avatarElement = document.getElementById('user-avatar');
            
            // Set up error handler for avatar image
            avatarElement.onerror = function() {
                console.error('Failed to load avatar from remote URL, using fallback');
                // Use fallback avatar if remote one fails
                const fallbackUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(userName)}&background=64ffda&color=0a192f`;
                avatarElement.src = fallbackUrl;
            };
            
            // Try to load remote avatar
            avatarElement.src = avatarUrl;
        }
        
        // Show error message
        function showError(message) {
            const mainContent = document.querySelector('main .max-w-4xl');
            mainContent.innerHTML = `
                <div class="glass rounded-lg p-8 text-center">
                    <i class="fa fa-exclamation-triangle text-yellow-500 text-4xl mb-4"></i>
                    <h2 class="text-2xl font-bold mb-4">出错了</h2>
                    <p class="text-gray-300 mb-6">${message}</p>
                    <a href="index.html" class="inline-flex items-center px-6 py-3 bg-secondary text-dark font-semibold rounded-md hover:bg-opacity-90 transition-colors duration-300">
                        <i class="fa fa-arrow-left mr-2"></i> 返回主页
                    </a>
                </div>
            `;
        }
        
        // Update current time
        function updateTime() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit',
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false
            };
            document.getElementById('current-time').textContent = now.toLocaleString('zh-CN', options);
        }
    </script>
</body>
</html>
